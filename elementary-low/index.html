<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>드론 시뮬레이터 - 저학년</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="canvas-container"></div>

    <!-- 상단 바 -->
    <div id="top-bar">
        <a href="../index.html" class="back-btn">&#x2B05; 처음으로</a>
        <span class="mode-label">&#x2B50; 저학년 모드</span>
    </div>

    <!-- 튜토리얼 오버레이 -->
    <div id="tutorial-overlay">
        <div class="tutorial-box">
            <h2>&#x1F681; 드론 조종을 배워봐요!</h2>
            <p>&#x1F7E2; 초록 버튼을 누르면 드론이 날아올라요</p>
            <p>&#x2B06;&#x2B07;&#x2B05;&#x27A1; 화살표 버튼으로 방향을 바꿔요</p>
            <p>&#x2B06;위로 &#x2B07;아래로 버튼으로 높이를 조절해요</p>
            <p>&#x1F7E0; 주황 버튼을 누르면 착륙해요</p>
            <button class="start-btn" id="btn-start" onclick="window._droneStarted=true;document.getElementById('tutorial-overlay').style.display='none';">시작하기!</button>
        </div>
    </div>

    <!-- 버전 표시 (디버깅용) -->
    <div style="position:fixed;bottom:2px;left:2px;color:rgba(255,255,255,0.3);font-size:9px;z-index:99999;pointer-events:none;font-family:monospace;">v5-low</div>

    <!-- 에러 핸들러 -->
    <script>
    window.onerror = function(msg, url, line, col, error) {
        var d = document.createElement('div');
        d.style.cssText = 'position:fixed;top:0;left:0;right:0;background:red;color:white;padding:15px;z-index:99999;font-size:14px;font-family:monospace;white-space:pre-wrap;';
        d.textContent = 'ERROR: ' + msg + '\nFile: ' + url.split('/').pop() + ':' + line;
        document.body.appendChild(d);
    };
    </script>

    <!-- Three.js -->
    <script src="../shared/three.min.js?v=5"></script>

    <!-- 공유 모듈 -->
    <script src="../shared/drone-physics.js?v=5"></script>
    <script src="../shared/drone-model.js?v=5"></script>
    <script src="../shared/world.js?v=5"></script>
    <script src="../shared/camera.js?v=5"></script>
    <script src="../shared/ui-components.js?v=5"></script>

    <!-- 미션 시스템 -->
    <script src="../shared/mission-framework.js?v=5"></script>
    <script src="js/missions-low.js?v=5"></script>

    <!-- 저학년 전용 -->
    <script src="js/simple-controls.js?v=5"></script>

    <!-- 모듈 로드 진단 -->
    <script>
    (function() {
        var ds = window.DroneSim || {};
        var needed = ['DronePhysics','DroneModel','World','CameraSystem','HUD','MessageDisplay','Minimap','MissionManager','MissionSelectUI','SimpleControls','createLowMissions'];
        var missing = needed.filter(function(n) { return !ds[n]; });
        if (missing.length > 0) {
            var d = document.createElement('div');
            d.style.cssText = 'position:fixed;top:50px;left:0;right:0;background:#cc0;color:#000;padding:15px;z-index:99999;font-size:14px;font-family:monospace;';
            d.textContent = 'MISSING MODULES: ' + missing.join(', ');
            document.body.appendChild(d);
        }
        if (typeof THREE === 'undefined') {
            var d = document.createElement('div');
            d.style.cssText = 'position:fixed;top:100px;left:0;right:0;background:orange;color:#000;padding:15px;z-index:99999;font-size:14px;font-family:monospace;';
            d.textContent = 'THREE.js NOT LOADED';
            document.body.appendChild(d);
        }
    })();
    </script>

    <script src="js/app.js?v=5"></script>
</body>
</html>
